<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head}"></head>
<body>
<nav th:replace="~{layout :: nav}"></nav>

<div class="container mt-10">
    <div class="content-wrapper">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="page-title mb-0">
                <i class="bi bi-building"></i> Gerenciar Distritos
                <small class="text-white d-block mt-2" style="font-size: 1rem;" th:text="'Usuário: ' + ${usuario.nmUsuario}"></small>
            </h2>
            <a th:href="@{/web/usuarios}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Voltar
            </a>
        </div>

        <!-- Mensagem de Sucesso -->
        <div th:if="${mensagem}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle"></i> <span th:text="${mensagem}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Mensagem de Erro -->
        <div th:if="${erro}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle"></i> <span th:text="${erro}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Distritos Inscritos -->
        <div class="card border-0 shadow-sm mb-4 mt-5">
            <div class="card-body">
                <h5 class="mb-4">
                    <i class="bi bi-check-circle-fill text-success"></i> Distritos Inscritos
                </h5>

                <div th:if="${#lists.isEmpty(distritosInscritos)}" class="text-center py-5 text-muted">
                    <i class="bi bi-inbox display-1"></i>
                    <p class="mt-3">Nenhum distrito inscrito ainda.</p>
                </div>

                <div th:unless="${#lists.isEmpty(distritosInscritos)}">
                    <div th:each="distrito : ${distritosInscritos}" class="mb-3">
                        <div class="d-flex justify-content-between align-items-center p-3"
                             style="background: #f0fdf4; border-radius: 8px; border: 1px solid #86efac;">
                            <div class="flex-grow-1">
                                <h6 class="mb-1 fw-semibold" th:text="${distrito.nmDistrito}"></h6>
                                <div class="mb-2">
                                    <span class="badge bg-success" th:text="${distrito.areaDistrito}"></span>
                                </div>
                                <p th:if="${distrito.dsDistrito}" class="mb-0 text-muted small" th:text="${distrito.dsDistrito}"></p>
                            </div>
                            <form th:action="@{/web/usuarios/{usuarioId}/distritos/{distritoId}/desinscrever(usuarioId=${usuario.idUsuario}, distritoId=${distrito.idDistrito})}"
                                  method="post" class="ms-3">
                                <button type="submit"
                                        class="btn btn-outline-danger btn-sm"
                                        onclick="return confirm('Tem certeza que deseja desinscrever deste distrito?')"
                                        title="Desinscrever">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
                                    </svg>
                                    Desinscrever
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Distritos Disponíveis -->
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <h5 class="mb-4">
                    <i class="bi bi-plus-circle-fill text-primary"></i> Distritos Disponíveis
                </h5>

                <div th:if="${#lists.isEmpty(distritosDisponiveis)}" class="text-center py-5 text-muted">
                    <i class="bi bi-check-circle display-1"></i>
                    <p class="mt-3">Todos os distritos já estão inscritos!</p>
                </div>

                <div th:unless="${#lists.isEmpty(distritosDisponiveis)}">
                    <div th:each="distrito : ${distritosDisponiveis}" class="mb-3">
                        <div class="d-flex justify-content-between align-items-center p-3"
                             style="background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <div class="flex-grow-1">
                                <h6 class="mb-1 fw-semibold" th:text="${distrito.nmDistrito}"></h6>
                                <div class="mb-2">
                                    <span class="badge bg-primary" th:text="${distrito.areaDistrito}"></span>
                                </div>
                                <p th:if="${distrito.dsDistrito}" class="mb-0 text-muted small" th:text="${distrito.dsDistrito}"></p>
                            </div>
                            <form th:action="@{/web/usuarios/{usuarioId}/distritos/{distritoId}/inscrever(usuarioId=${usuario.idUsuario}, distritoId=${distrito.idDistrito})}"
                                  method="post" class="ms-3">
                                <button type="submit"
                                        class="btn btn-outline-success btn-sm"
                                        title="Inscrever">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                                    </svg>
                                    Inscrever
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer th:replace="~{layout :: footer}"></footer>
<div th:replace="~{layout :: scripts}"></div>
</body>
</html>
